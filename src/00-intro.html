<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Introducción</title>
    <meta charset="utf-8" />
    <meta name="author" content="Alberto Torres y Irene Rodríguez" />
    <meta name="date" content="2019-10-27" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introducción
## Fundamentos lenguajes: R
### Alberto Torres y Irene Rodríguez
### 2019-10-27

---

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
    Macros: {
      Xcal: "{\\mathcal{X}}",
      Xbf: "{\\mathbf{X}}",
      Qbf: "{\\mathbf{Q}}",
      Zbf: "{\\mathbf{Z}}",
      Vbf: "{\\mathbf{V}}",
      Hbf: "{\\mathbf{H}}",
      Rbb: "{\\mathbb{R}}"
    },
    extensions: ["AMSmath.js","AMSsymbols.js"]
  }
});
</script>



&lt;!-- util: https://atrebas.github.io/post/2019-03-03-datatable-dplyr/ --&gt;

## ¿Qué es R?

- R es un lenguaje de programación y un entorno para **manipular datos**, **realizar cálculos y gráficos**.
- R es un lenguaje **interpretado**, por lo que no es necesario compilar el código fuente.
- **Herramienta muy popular** para tareas de Data Science (junto con Python)
- Comparado con herramientas clásicas (Excel, SaS, SPSS)
    + Más flexible
    + Curva de aprendizaje inclinada
    + **Librerías**/**Paquetes**!

---

## Ventajas de R

- Proyecto GNU (**open source**), cualquiera puede contribuir al desarrollo.
- Gran cantidad de **paquetes/librerías** (9319 a 10 de octubre de 2019 -&gt; 15103 a 12 de octubre de 2019):
  + https://cran.r-project.org/web/packages/
- La gran mayoría de nuevas tecnologías y algoritmos relacionados con **estadística** aparecen primero en R.
- **Documentación** abundante en Internet, muchos **grupos de usuarios** activos.
  + https://cran.r-project.org/other-docs.html

&lt;img src="img/why_learn_r.jpg" width="50%" style="display: block; margin: auto;" /&gt;

---

## Inconvenientes de R

- **Curva de aprendizaje inclinada**, como la mayoría de lenguajes de programación.

&lt;img src="img/curva_de_aprendizaje.png" width="50%" style="display: block; margin: auto;" /&gt;

- La calidad de algunos paquetes.
- **Gestión de memoria**
- **Menor rendimiento** que otros lenguajes de cálculo científico.

---

## Comparación de rendimiento


&lt;img src="img/rendimiento.png" width="100%" style="display: block; margin: auto;" /&gt;
Tiempos de benchmark **relativos a C** (rendimiento de C=1.0). Fuente: https://julialang.org/

---


## R versus Python

&lt;img src="img/r_vs_python.png" width="2500px" style="display: block; margin: auto;" /&gt;


---
  
## Entorno

- R es **interpretado** &amp;rarr; intérprete de R.
- El **intérprete de R** (Base R) está disponible para los principales sistemas operativos (Windows, Linux, MacOS): 
    + [http://cran.r-project.org](http://cran.r-project.org)

- Recomendado el uso del IDE RStudio
    + [http://www.rstudio.com](http://www.rstudio.com)
    + RStudio proporciona un entorno similar al de Matlab o al entorno Spyder de Anaconda.
    
---


## Entorno R: Instalando R y RStudio

**Base R**
.pull-left[
1. Descargar la versión adecuada de acuerdo al sistema operativo:
    + [Linux](https://cran.r-project.org/bin/linux/)
    + [Windows](https://cran.r-project.org/bin/windows/base/)
    + [OSX](https://cran.r-project.org/bin/macosx/)
]

.pull-right[
2. Arrancar el ejecutable:
&lt;img src="img/r_ejecutable" width="100%" style="display: block; margin: auto;" /&gt;
]


---

## Entorno R: Instalando R y RStudio

&lt;img src="img/Rstudio.png" width="100%" style="display: block; margin: auto;" /&gt;

---

## Librerías


- R tiene una colección de **más de 12.000 librerías o paquetes de terceros**.
- La mayoría disponibles en un repositorio centralizado (CRAN).
- No forman parte del núcleo de R (R base).
  + Base R contiene muchas de las fucniones que se utilizarán comúnmente como `mean()` o `hist()`.
  + Solo las funciones implementadas por los autores originales de R se pueden encontrar en Base R.
- Se pueden instalar muy facilmente.
- Mucha de la funcionalidad de R viene dada por la cantidad de paquetes que existen.
  + [https://support.rstudio.com/hc/en-us/articles/201057987-Quick-list-of-useful-R-packages](https://support.rstudio.com/hc/en-us/articles/201057987-Quick-list-of-useful-R-packages)
  
---

## Instalar y cargar librerías


- **Instalando un nuevo paquete (I)**
  + Dos maneras comunas de instalar paquetes:
    1. Descarga del paquete de [CRAN](https://cran.r-project.org/)
      - Podemos instalar nuevas librerías con la sentencia:
      
      ```r
      install.packages("tidyverse")
      ```
      - RStudio también permite instalar el paquete de forma gráfica: `Packages &gt; Install`
    2. Descarga del paquete de **Github**
      - Es necesario usar la funcion `install_github` que está en el paquete `devtools`
      
      ```r
      install.packages("devtools")
      library("devtools")
      install_github("ndphillips/yarrr", build_vignetes=TRUE)
      ```

---

## Instalar y cargar librerías


- **Instalando un nuevo paquete (II)**
  + Una vez instalado el paquete, no es necesario instalarlo nuevamente (salvo que se quiera instalar una nueva versión).
  
  + Si se quiere desinstalar/eliminar un paquete:
  
  1. Se puede hacer desde línea de comandos: `remove.packages(pkgs,lib)`
    
  2. Se pude hacer desde el entorno gráfico de RStudio: en la pestaña `Packages`, presionar el icono X al lado del nombre del paquete.
  

---

## Instalar y cargar librerías

- **Cargando un paquete**
  + Siempre que se quiera usar un paquete, éste deberá cargarse primero en la sesión de trabajo.
  
  + Para cargar un paquete se utiliza la función `library()`:
    
    ```r
    library(tidyverse)
    ```
  
  + También se puede cargar un paquete en el entorno gráfico, seleccionando el paquete en el menú `Packages`.
  
  + Una vez cargado, se pueden utilizar las funciones y datos definidos en el paquete.
  + Si se quiere "deshacer" la carga del paquete:
    - Desde línea de comandos: `detach("package:coda", unload=TRUE)`
    - Desde RStudio: quitar &amp;#9745; del paquete en el menú `Packages`.
---

## Instalar y cargar librerías

&lt;img src="img/librerias.png" width="45%" style="display: block; margin: auto;" /&gt;
---


## Instalar y cargar librerías


```r
install.packages(“circlize”)
library("circlize")
mat &lt;- matrix(sample(1:100,6*7,replace=TRUE),6,7)
chordDiagram(mat)
remove.packages(“circlize”)
```
---


## Tidyverse

- Colección de paquetes diseñados para tareas de Data Science

- No son estrictamente necesarios, pero simplifican las tareas más comunes

- Los principales son: `dplyr`, `ggplot2`, `tidyr`, `readr`, `purrr`, `stringr`, `forcats` y `tibble`


---

## Comandos de R

- Distinguen entre mayúsculas y minúsculas.
- Los **comentarios** comienzan con el símbolo `#`.
- Se clasifican en **asignaciones** (el resultado se guarda) y **expresiones** (el resultado se imprime y se pierde).
- El operador de asignación es `&lt;-` o `-&gt;` (no es aconsejable usar `=`).



```r
# este resultado se muestra y se pierde
2 + 2
## [1] 4
```


```r
# el resultado de la operación se almacena en una nueva variable 
# `suma`
suma &lt;- 2 + 2
```

- Un **fichero de comandos** se carga con la expresión:

```r
source("fichero.R")
```

- Para obtener **ayuda** sobre un determinado comando se utiliza la expresión `help("sum")`; o, alternativamente `?sum`.

---


## Funciones

- Construcción de R que toma unos argumentos de entrada, realiza un cálculo y devuelve un resultado
- El prototipo de las funciones en R tiene la siguiente forma:

```r
  funcion(param, param2, ...., key1 = val1, key2 = val2,...)
```
- Los parámetros `key1 = val1` asignan el valor por defecto `val1` al parámetro `key1` y, por tanto, son **opcionales**.
- Los paramétros sin valor por defecto son **obligatorios** y deben especificarse en la llamada a la función.
- En R es común que las fucniones reciban un parámetro de forma de **lista de longitud variable**. Este parámetro se especficia con `...`.
  + Puede ser útil cuando se quiere escribir un número variable de argumentos o se quieren pasar argumentos adicionales a otra función que se invoca desde la primera.
- Ejemplos:

```r
vector(mode = "logical", length=0)
aggregate(x, ...)
```

---

## Funciones
- Cuando se invoca a una función en R, se le pueden pasar los argumentos de 3 formas (por orden de prioridad):
  1. **Nombres exactos**: Los parámetros se asignan a los &lt;u&gt;nombres completos&lt;/u&gt; explícitamente dados como argumentos.
  2. **Nombres parciales**: Los parámetros se asocian con &lt;u&gt;nombres parciales&lt;/u&gt; explíticamente dados como argumentos.
  3. **Orden de los parámetros**: Los parámetros se asignan a los nombres en función a su &lt;u&gt;posición&lt;/u&gt; en la llamada.
  
- **Ejemplo: función vector** `?vector`

```r
vector(length=10)
##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
vector(len=10, mode="numeric")
##  [1] 0 0 0 0 0 0 0 0 0 0
vector("numeric",10)
##  [1] 0 0 0 0 0 0 0 0 0 0
```

---

## Objetos y atributos

- R se compone de **objetos**.
- **¿Qué es un objeto?** Todas las entidades que R crea y manipula (escalares, vectores, *dataframes*, el resumen estadístico de una variable, un test estadístico, una función, etc.).
- Los objetos se almacenan en la **memoria RAM** del ordenador con un nombre específico.
* Para listar todos los objetos en memoria: `ls()`.
* Para eliminar la variable x de la memoria: `rm(x)`.
* Para eliminar todos los objetos de la memoria: `rm(list=ls())`.

---

## Objetos y atributos
- Al cerrar la sesión de R se pueden almacenar todos los objetos en el fichero `.RData`.
- Al abrir una nueva sesión se cargarán los objetos del fichero `.RData` almacenado en el directorio actual (si existe).

&lt;img src="img/Rdata.png" width="80%" style="display: block; margin: auto;" /&gt;

---

## Objetos y atributos

- Los tipos de datos **básicos** de R son: `logical`, `integer`, `double`, `complex`, `raw`, `character`, `list`, `NULL`, `closure (function)`, `special`, `builtin`, `environment`, `S4` ...
- El modo en un objeto es el tipo básico de los elementos que contiene. Viene dado por las funciones `mode()` y `typeof()`.


```r
suma &lt;- 2+2
typeof(suma)
## [1] "double"
mode(suma)
## [1] "numeric"
```

- Las funciones `is.integer()`, `is.numeric()`, etc. devuelven TRUE o FALSE dependiendo de si el objeto es del tipo especificado o no.

```r
is.integer(suma)
## [1] FALSE
is.character(suma)
## [1] FALSE
```

---

## Objetos y atributos

- Para convertir de un modo a otro se utilizan las fucniones `as.integer()`, `as.numeric()`, etc.
  + Cualquier número diferente a 0 se convierte al valor lógico TRUE, mientras que el 0 se corresponde a FALSE.
  + El valor lógico TRUE se convierte con el valor numérico 1, mientras que valor lógico FALSE se corresponde con el valor numérico 0.
  

```r
as.character(suma)
## [1] "4"
as.logical(suma)
## [1] TRUE
cero &lt;- 0 
as.logical(cero)
## [1] FALSE
```

---

## Objetos y atributos

- Diferentes tipos de objetos tienen diferentes atributos.
  + La lista de atributos de un objeto se puede obtener con la función `attributes()`.
  + Para obtener o modificar un atributo en particular, se puede utilizar la función `attr(objeto, "nombre del atributo")`.


```r
library(stats)
head(cars)
##   speed dist
## 1     4    2
## 2     4   10
## 3     7    4
## 4     7   22
## 5     8   16
## 6     9   10
attributes(cars)
## $names
## [1] "speed" "dist" 
## 
## $row.names
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
## [24] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46
## [47] 47 48 49 50
## 
## $class
## [1] "data.frame"
```

---

## Objetos y atributos


&lt;img src="img/objetos_atributos.png" width="100%" style="display: block; margin: auto;" /&gt;


---

## Vectores

- Un vector es una secuencia de datos del &lt;u&gt;mismo tipo básico&lt;/u&gt;.
  + Un escalar, carácter, etc. son vectores de longitud 1.
- Ejemplos para crear vectores:
  + **Función `c()` (combinar)**:

```r
c(3.14, 15, 92)
## [1]  3.14 15.00 92.00
c("cadena", "d", 'caracteres')
## [1] "cadena"     "d"          "caracteres"

# En caso de que los argumentos sean de distinto tipo se castean al tipo
# más general de acuerdo al orden: NULL &lt; raw &lt; logical &lt; integer &lt;
# double &lt; complex &lt; character &lt; list &lt; expression
c(TRUE, 3.14, "pi")
## [1] "TRUE" "3.14" "pi"
```
  + **Función `vector()`**:

```r
vector()
## logical(0)
vector("numeric",10)
##  [1] 0 0 0 0 0 0 0 0 0 0
```

---

## Vectores

- Ejemplos para crear vectores:
  + **Función `rep(x, times, each)`**:

```r
rep(x=c("A","B","C"), each=2, times=3)
##  [1] "A" "A" "B" "B" "C" "C" "A" "A" "B" "B" "C" "C" "A" "A" "B" "B" "C"
## [18] "C"
rep(x=c(1,2,3), length.out=10)
##  [1] 1 2 3 1 2 3 1 2 3 1
```
  + **Función `a:b` (para vectores numéricos)**:

```r
1:10
##  [1]  1  2  3  4  5  6  7  8  9 10
2.5:8.5
## [1] 2.5 3.5 4.5 5.5 6.5 7.5 8.5
```
  + **Función `seq` (para vectores numéricos)**:


```r
seq(from=0.5, to=2.6, by=0.5)
## [1] 0.5 1.0 1.5 2.0 2.5
seq(from=10, to=1, by=-2)
## [1] 10  8  6  4  2
seq(from=9, to=1, length.out=4)
## [1] 9.000000 6.333333 3.666667 1.000000
```

---

## Vectores (aleatorios)

- R tiene varias funciones para generar números aleatorios.
  1. A partir de valores especificados
    
    ```r
    sample(x=1:10, size=5)
    ## [1]  9 10  8  3  6
    sample(x=1:10, size=20, replace=TRUE)
    ##  [1]  8  9  2  5  3  8  6  4  1  3  7  7  5  5  5  7 10  4  5  1
    # Ejercicio: simular 5 tiradas de una moneada trucada ("cara", "cruz") con probabilidad de "cara" de 0.8
    ```
  
  2. A partir de distribuciones de probabilidad conocidas (normal, uniforme, etc.). Para ver todas las distribuciones: `?Distributions`.
    
    ```r
    rnorm(n=10, mean=4, sd=0.5)
    ##  [1] 3.437192 3.435461 4.616100 4.163144 3.369170 4.287378 3.445728
    ##  [8] 3.878429 3.050824 3.861378
    runif(n=10, min=4, max=10)
    ##  [1] 5.027536 4.814617 5.186726 6.837023 8.205702 6.268206 8.936280
    ##  [8] 7.262343 9.588993 5.933379
    ```

---


## Operaciones sobre vectores


```r
x &lt;- 1:10
# Longitud del vector
length(x)
## [1] 10

# Operaciones con escalares: +,-,*,/,^,%% y %/%
x*4
##  [1]  4  8 12 16 20 24 28 32 36 40

# Operaciones con vectores de igual longitud
y &lt;- 10:1
x + y
##  [1] 11 11 11 11 11 11 11 11 11 11

# Operaciones con vectores de distinta longitud:
# los vectores más cortos reciclan sus elementos hasta tener la 
# longitud del más largo
z &lt;- 10:8
x + z
##  [1] 11 11 11 14 14 14 17 17 17 20

# Operaciones lógicas: !, &amp;, |, xor(x,y)
x &lt;- 1:3
z &lt;- c(1,0,3)
!z
## [1] FALSE  TRUE FALSE
x &amp; z
## [1]  TRUE FALSE  TRUE
```
---

## Operaciones sobre vectores


```r
# Funciones: log, exp, sin, cos, tan, sqrt, ceiling, floor, round...
x &lt;- pi * 1:5
sin(x)
## [1]  1.224647e-16 -2.449294e-16  3.673940e-16 -4.898587e-16  6.123234e-16

# Funciones estadísticas: sum, product, min, max, mean, sd, var, quantile, summary
x &lt;- rnorm(n=5, mean=10, sd=5)
mean(x)
## [1] 11.1843
summary(x)
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   5.763  10.356  10.725  11.184  14.029  15.048

# ¡OJO con los missing values!
x &lt;- c(1,2,3,NA,5,6,NA,8,9,0)
mean(x)
## [1] NA
mean(x,na.rm=T)
## [1] 4.25

# Valores únicos y conteo
x &lt;- rep(c("a","b",NA),each=2,length.out=15)
unique(x)
## [1] "a" "b" NA
# Si no ponemos exclude=NULL no contará los missing values
table(x,exclude=NULL)
## x
##    a    b &lt;NA&gt; 
##    6    5    4
```


---

## Indexado de vectores

- **Ejemplo**: seleccionar el primer y tercer elemento del vector `x &lt;- c(5, -8, 2, -1)`.


```r
x &lt;- c(5, -8, 2, -1)
# 1. Indexado por vector lógico
y &lt;- c(TRUE, FALSE, TRUE, FALSE)
x[y]
## [1] 5 2

# 2. Indexado por vector de enteros positivos
y &lt;- c(1,3)
x[y]
## [1] 5 2

# 3. Indexado por vector de enteros negativos
y &lt;- c(-2, -4)
x[y]
## [1] 5 2

# 4. Indexado por vecor de nombres (¡solo si el vector tiene nombres!)
names(x) &lt;- c("primero","segundo","tercero","cuarto")
y &lt;- c("primero","tercero")
x[y]
## primero tercero 
##       5       2
```

---

### Indexado de vectores por condiciones lógicas

- Es común obtener los índices de indexado a partir de operaciones lógicas sobre el propio vector u otros vectores.

```r
# Obtener los elementos mayores a 5 de un vector
x &lt;- c(3,4,6,1,6,3,2,10,7)
x[x&gt;5]
## [1]  6  6 10  7

# Obtener la edad media de los hombres
genero &lt;- c("H","M","M","H","H","M")
edad &lt;- c(25, 21, 34, 45, 22, 61)
mean(edad[genero=="H"])
## [1] 30.66667

# Contar el número de elmentos de un vector mayores que 0
x &lt;- rep(x = c(1,-1), each=5)
sum(x &gt; 0)
## [1] 5

# Indices de elementos mayores a 0
which(x&gt;0)
## [1] 1 2 3 4 5

# Proporción de elementos mayores que 0.
mean(x &gt; 0)
## [1] 0.5
```

---

## Indexado de vectores por condiciones lógicas

- R tiene muchas funciones que toman vectores como argumentos y devuelven vectores lógicos obtenidos en base a múltiples criterios.

&lt;img src="img/funcs_vectores.png" width="100%" style="display: block; margin: auto;" /&gt;

---

## Asignación en vectores

- ¡OJO!


```r
x &lt;- rep(x = c(1,-1), each=5)
x[1:5] &lt;- 20:99
x
##  [1] 20 21 22 23 24 -1 -1 -1 -1 -1

x[1:3] &lt;- c(1,2)
x
##  [1]  1  2  1 23 24 -1 -1 -1 -1 -1

x[1:4] &lt;- c(1,2)
x
##  [1]  1  2  1  2 24 -1 -1 -1 -1 -1
```

---

## Arrays
- Un **array** es una colección de datos del &lt;u&gt;mismo tipo&lt;/u&gt; indexada por &lt;u&gt;varios índices&lt;/u&gt;.
- Una **matriz** es un array de 2 dimensiones.
- R implementa los arrays como vectores (no como vectores de vectores, o una lista de vectores), **pero con los atributos `dim` y, opcionalmente, `dimnames`**.
- La función `array` se utiliza para crear arrays. Los valores especificados para la inciialización se rellenan con el primer índice variando más rápido.


```r
x &lt;- 1:10
a &lt;- array(x, dim=c(5,2))
a
##      [,1] [,2]
## [1,]    1    6
## [2,]    2    7
## [3,]    3    8
## [4,]    4    9
## [5,]    5   10

# Con dim recuperamos las dimensiones del array
dim(a)
## [1] 5 2
```

---

## Indexado de arrays
- El indexado de arrays es como el indexado de vectores en cada una de las dimensiones del array.


```r
z &lt;- array(1:60, dim=c(3,5,4))
z[1:2, -(1:4), 2]
## [1] 28 29

# Si un vector índice está vacío, se selecciona todo el rango
# de valores
z[,1,1]
## [1] 1 2 3

# Los arrays también se pueden indexar con otro array de índices
idx &lt;- array(c(1:2, 1:3), dim=c(2,3))
idx
##      [,1] [,2] [,3]
## [1,]    1    1    3
## [2,]    2    2    1
z[idx]
## [1] 31  5
```
---

## Aritmética de arrays

- En los arrays se pueden emplear operaciones aritméticas y lógicas (elemento a elemento).
  + A diferencia de los vectores, los arrays tienen que tener la misma longitud en todas las dimensiones.
- Las funciones `log`, `exp`, `sin`, `cos`, etc. se calculan elemento a elemento del array.
- Las funciones `sum`, `mean`, `var`, etc. se pueden aplicar en arrays de igual forma que en vectores y devuelven la suma, media, varianza, etc. de todos los elementos.
- Las funciones `colSums`, `rowSums`, `colMeans`, `rowMeans` calculan la suma y la media, respectivamente, a lo largo de la dimensión especificada.


```r
z &lt;- array(1:20, c(10,2))
mean(z)
## [1] 10.5
colSums(z)
## [1]  55 155
rowSums(z)
##  [1] 12 14 16 18 20 22 24 26 28 30
```

---

## Matrices
- Una matriz es un array de 2 dimensiones.
  + Se pueden utilizar las mismas **funciones** que para los arrays.
  + El **indexado** se realiza de igual forma que para los arrays.
  + Se puede crear la matriz usando `array` o `matrix`.

```r
m &lt;- matrix(1:10, nrow=2,ncol=5)
m
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    3    5    7    9
## [2,]    2    4    6    8   10
```


&lt;img src="img/funcs_matrices.png" width="90%" style="display: block; margin: auto;" /&gt;


---

## Listas
- Una lista consiste en una colección ordenada de objetos &lt;u&gt;del mismo o distinto tipo&lt;/u&gt;.
- Las listas son un elemento muy importante en R, ya que permiten la construcción de **estructuras heterogéneas**.
  + Los *dataframes* se basan en listas.
- Una lista se crea con la función `list`.
  + Si un elemento se especifica como `nombre=valor`, entonces, ese elemento en la lista tiene el nombre `nombre`.
  + Se puede acceder a los nombres de los elementos con la función `names()`.
  

```r
parcela &lt;- list(destino="Madrid", dimensiones=c(2,6,9),
precio=51000)
parcela
## $destino
## [1] "Madrid"
## 
## $dimensiones
## [1] 2 6 9
## 
## $precio
## [1] 51000
```

---

## Indexado de listas

- Los componentes de la lista &lt;u&gt;siempre están numerados&lt;/u&gt; y son accesibles mediante **dobles corchetes**.

```r
parcela[[1]]
## [1] "Madrid"
parcela[["dimensiones"]]
## [1] 2 6 9
```
- Los componentes también se pueden acceder con el operador `$`:

```r
parcela$precio
## [1] 51000
```
- Se puede obtener una **sublista** usando **corchetes simples** y el mismo indexado visto para vectores.

```r
parcela[c(1,2)]
## $destino
## [1] "Madrid"
## 
## $dimensiones
## [1] 2 6 9
```
---

## Operaciones sobre listas


```r
# se pueden modificar sus elementos
parcela$destino &lt;- "Granada"

# Si el nombre del elemento no existe, se añade a la lista:
parcela$titular &lt;- "Francisco Ruiz"

# Las listas se pueden combinar con la función c()
new &lt;- list(anyocompra=2014, telefonos=c(912596582,916359875))
c(parcela, new)
## $destino
## [1] "Granada"
## 
## $dimensiones
## [1] 2 6 9
## 
## $precio
## [1] 51000
## 
## $titular
## [1] "Francisco Ruiz"
## 
## $anyocompra
## [1] 2014
## 
## $telefonos
## [1] 912596582 916359875
```

---

## Factores
- Un factor es un vector que contiene una clasificación discreta de sus elementos.
- Se suelen utilizar para almacenar **variables categóricas** (hombre/mujer).
- Se crean con la función `factor` y se pueden ver los **niveles** (valores distintos) con la función `levels`:

```r
genero &lt;-
factor(c("hombre","mujer","mujer","mujer","hombre","hombre","mujer","hombre","hombre","mujer","mujer","hombre"))
levels(genero)
## [1] "hombre" "mujer"
```

- Los **factores ordenados** permiten establecer un orden en las categorías. Ejemplo: encuesta de satisfacción.

```r
encuesta.resultados &lt;- factor(c("Desacuerdo","Neutral","Fuertemente desacuerdo","Neutral","Deacuerdo","Fuertemente deacuerdo","Desacuerdo","Fuertemente deacuerdo","Neutral", "Fuertemente desacuerdo","Neutral","Deacuerdo"), levels=c("Fuertemente desacuerdo","Desacuerdo","Neutral","Deacuerdo","Fuertemente deacuerdo"),ordered=TRUE)
encuesta.resultados
##  [1] Desacuerdo             Neutral                Fuertemente desacuerdo
##  [4] Neutral                Deacuerdo              Fuertemente deacuerdo 
##  [7] Desacuerdo             Fuertemente deacuerdo  Neutral               
## [10] Fuertemente desacuerdo Neutral                Deacuerdo             
## 5 Levels: Fuertemente desacuerdo &lt; Desacuerdo &lt; Neutral &lt; ... &lt; Fuertemente deacuerdo
```



---
## Data frames

- Tabla para almacenar datos en R
- Está compuesto por observaciones (filas) y variables (columnas)
- Cada variable puede ser de un tipo distinto (texto, categórica, numérica, etc.)
- Todas las observaciones de una misma variable tienen que ser del mismo tipo
- Cada variable tiene un nombre.


&lt;img src="img/dataframe.png" width="90%" style="display: block; margin: auto;" /&gt;


---

## Referencias y ayuda

- La referencia principal del curso es el libro "[R for Data Science](https://r4ds.had.co.nz/)" de Hadley Wickham y Garret Grolemund (O'Reilly 2017)

- Tiene una versión online gratuita

- Hadley Wickham es además el creador de muchos de los paquetes que componen el [tidyverse](https://www.tidyverse.org/)

- TODO: poner enlace a cheatsheet

- Acceder a la ayuda de R:

```r
?mean
help(mean)
```

---


## Más información sobre R

- **Documentación y manunales de R**: https://www.r-project.org/
- **R Reference Card**: https://cran.r-project.org/doc/contrib/Short-refcard.pdf
- **Nivel Básico**:
  + Phillips, Nathaniel D. *YaRrr! The Pirate’s Guide to R*: http://nathanieldphillips.com/thepiratesguidetor/
  + Introducción a R: https://cran.r-project.org/doc/contrib/R-intro-1.1.0-espanol.1.pdf
  + R para principiantes: https://cran.r-project.org/doc/contrib/rdebuts_es.pdf
- **Nivel avanzado**:
  + Adler, Joseph. *R in a nutshell: A desktop quick reference*. " O'Reilly Media, Inc.", 2010.
  + Burns, Patrick. *The R Inferno*. http://www.burns-stat.com/pages/Tutor/R_inferno.pdf
  + Crawley, Michael J. *The R Book*.
  + Colección *Use R!*, Springer.

---

## Más información sobre R

- [StackOverflow](https://stackoverflow.com/questions/tagged/r). Las preguntas con el **tag R** contienen mucha información y problemas resueltos. Además, las nuevas preguntas se responden en cuestión de horas.
- [CressValidated](https://stats.stackexchange.com/). No es una comunidad específica de R (más bien estadística), pero hay mucha información acerca de cómo realizar procedimientos concretos de análisis de datos y aprendizaje automático en R.
- [@RLangTip](https://twitter.com/RLangTip). Cuenta de Twitter que publica consejos y trucos diarios.
- [The R Project for Statistical Computing](https://twitter.com/RLangTip). Grupo de LinkedIn.



---

## Funciones de data frames

Número de filas

```r
nrow(mpg)
## [1] 234
```

Número de columnas

```r
ncol(mpg)
## [1] 11
```

---

Nombres de las columnas

```r
colnames(mpg)
##  [1] "manufacturer" "model"        "displ"        "year"        
##  [5] "cyl"          "trans"        "drv"          "cty"         
##  [9] "hwy"          "fl"           "class"
```

Primeras líneas

```r
head(mpg)
## # A tibble: 6 x 11
##   manufacturer model displ  year   cyl trans  drv     cty   hwy fl    class
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1 audi         a4      1.8  1999     4 auto(… f        18    29 p     comp…
## 2 audi         a4      1.8  1999     4 manua… f        21    29 p     comp…
## 3 audi         a4      2    2008     4 manua… f        20    31 p     comp…
## 4 audi         a4      2    2008     4 auto(… f        21    30 p     comp…
## 5 audi         a4      2.8  1999     6 auto(… f        16    26 p     comp…
## 6 audi         a4      2.8  1999     6 manua… f        18    26 p     comp…
```

---

## str

Estructura del data frame

```r
str(mpg)
## Classes 'tbl_df', 'tbl' and 'data.frame':	234 obs. of  11 variables:
##  $ manufacturer: chr  "audi" "audi" "audi" "audi" ...
##  $ model       : chr  "a4" "a4" "a4" "a4" ...
##  $ displ       : num  1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...
##  $ year        : int  1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...
##  $ cyl         : int  4 4 4 4 6 6 6 4 4 4 ...
##  $ trans       : chr  "auto(l5)" "manual(m5)" "manual(m6)" "auto(av)" ...
##  $ drv         : chr  "f" "f" "f" "f" ...
##  $ cty         : int  18 21 20 21 16 18 18 18 16 20 ...
##  $ hwy         : int  29 29 31 30 26 26 27 26 25 28 ...
##  $ fl          : chr  "p" "p" "p" "p" ...
##  $ class       : chr  "compact" "compact" "compact" "compact" ...
```

---

## summary

Estadísticas de las variables

```r
summary(mpg)
##  manufacturer          model               displ            year     
##  Length:234         Length:234         Min.   :1.600   Min.   :1999  
##  Class :character   Class :character   1st Qu.:2.400   1st Qu.:1999  
##  Mode  :character   Mode  :character   Median :3.300   Median :2004  
##                                        Mean   :3.472   Mean   :2004  
##                                        3rd Qu.:4.600   3rd Qu.:2008  
##                                        Max.   :7.000   Max.   :2008  
##       cyl           trans               drv                 cty       
##  Min.   :4.000   Length:234         Length:234         Min.   : 9.00  
##  1st Qu.:4.000   Class :character   Class :character   1st Qu.:14.00  
##  Median :6.000   Mode  :character   Mode  :character   Median :17.00  
##  Mean   :5.889                                         Mean   :16.86  
##  3rd Qu.:8.000                                         3rd Qu.:19.00  
##  Max.   :8.000                                         Max.   :35.00  
##       hwy             fl               class          
##  Min.   :12.00   Length:234         Length:234        
##  1st Qu.:18.00   Class :character   Class :character  
##  Median :24.00   Mode  :character   Mode  :character  
##  Mean   :23.44                                        
##  3rd Qu.:27.00                                        
##  Max.   :44.00
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
